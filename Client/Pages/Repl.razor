@page "/repl"

@using BlazorFiddlePoC.Shared;

@inject ComponentCompilationService CompilationService
@inject IJSRuntime JsRuntime

<h1>Hello, world!</h1>

Welcome to your new app.

<textarea style="width:100%" rows="10" @bind="@ComponentCode"></textarea>

<button @onclick="@Compile">Compile</button>

@code {
    public string ComponentCode { get; set; }

    public async Task Compile()
    {
        var result = CompilationService.CompileToAssembly("UserPage.razor", $@"
    @page ""/user-page""
    {ComponentCode}");

        await JsRuntime.InvokeVoidAsync("window.readFile", result.AssemblyBytes);


    }
}
